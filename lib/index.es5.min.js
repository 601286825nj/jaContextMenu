function _createForOfIteratorHelper(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||n&&e&&"number"==typeof e.length){t&&(e=t);function i(){}var r=0;return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(t="Object"===t&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,n,t){var i=e.match(/#[\w\d_-]+/),r=(r=e.match(/\.[\w\d_-]+/g)||[]).map(function(e){return e.substring(1)});e=e.match(/^[\w\d]+/)[0];var o=document.createElement(e);if(Array.isArray(n))t=n;else if("object"===_typeof(n)&&null!==n)for(var a in n)if("style"===a||"dataset"===a)for(var l in n[a])o[a][l]=n[a][l];else"classList"===a&&Array.isArray(n[a])?r=r.concat(n[a]):o[a]=n[a];else"string"!=typeof n&&"number"!=typeof n||(o.textContent=String(n));return t&&t.forEach(function(e){e instanceof HTMLElement?o.appendChild(e):null!=e&&console.error(e,"not instance of HTMLElement")}),i&&(o.id=i[0]),r&&(i=o.classList).add.apply(i,r),o}var config={cssId:"jacontextmenu-css",wrapperClassName:"jacontextmenu",defaultMenuWidth:200,menuItemHeight:24,menuItemDivideLineMargin:5,baseZIndex:1e3},MenuItem=function(){function i(e,n,t){_classCallCheck(this,i),_defineProperty(this,"parentMenu",void 0),_defineProperty(this,"level",void 0),_defineProperty(this,"el",void 0),_defineProperty(this,"itemOption",void 0),_defineProperty(this,"childMenu",void 0),this.parentMenu=t,this.level=e,this.itemOption=n,this.init()}return _createClass(i,[{key:"init",value:function(){var e,t=this,i=this.itemOption;"divide"===i.type||0===(null===(e=i.type)||void 0===e?void 0:e.indexOf("---"))?this.el=h("li.divide"):this.el=h("li",{classList:i.disabled?["disabled"]:[],onclick:function(e){var n;i.disabled||(n=t.parentMenu.payload,i.onclick&&i.onclick(e,n),i.children||t.parentMenu.closeAllMenus())},onmouseenter:i.children?function(e){t.showChildMenu(e)}:function(){t.hideOtherChildMenu()}},[h("span.label",i.label),i.tip&&h("span.tip",i.tip),i.children&&h("span.right-arrow")]),i.children&&(i.children.width||(i.children.width=this.parentMenu.width),this.childMenu=new Menu(this.level+1,i.children))}},{key:"showChildMenu",value:function(e){var n,t,i,r=this.childMenu.el;e.target.contains(r)||(e.target.classList.add(config.wrapperClassName+"_hover"),r.style.display="block",n=parseFloat(getComputedStyle(r).height),t=e.target.getBoundingClientRect(),i=this.parentMenu.width-5,e=-2,window.innerWidth-t.x-this.parentMenu.width<this.childMenu.width&&(i=5-this.childMenu.width),window.innerWidth-t.y+2<n&&(e=-n+config.menuItemHeight+2+1),this.childMenu.removeChildMenus(),r.style.transform="translate(".concat(i,"px, ").concat(e,"px)")),this.el.appendChild(r),this.childMenu.removeAllHover(),this.childMenu.payload=this.parentMenu.payload}},{key:"hideOtherChildMenu",value:function(){var e;null!==(e=this.parentMenu)&&void 0!==e&&e.removeChildMenus(),null!==(e=this.parentMenu)&&void 0!==e&&e.removeItemHover()}}]),i}(),Menu=function(){function t(e,n){_classCallCheck(this,t),_defineProperty(this,"level",void 0),_defineProperty(this,"el",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",0),_defineProperty(this,"items",void 0),_defineProperty(this,"children",[]),_defineProperty(this,"payload",void 0),this.level=e,this.items=n.items,this.width=n.width||config.defaultMenuWidth,this.init(),this.addChildren(n.items)}return _createClass(t,[{key:"init",value:function(){this.el=h("ul.".concat(config.wrapperClassName,".").concat(config.wrapperClassName,"-lv").concat(this.level),{dataset:{lv:this.level},style:{width:this.width+"px",zIndex:+config.baseZIndex+this.level},onclick:function(e){return e.stopPropagation()},oncontextmenu:function(e){e.stopPropagation(),e.preventDefault()}})}},{key:"addChildren",value:function(e){var n=this;if(!Array.isArray(e))return console.error("option.items is not type of array");var t,i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.children.push(new MenuItem(this.level,r,this))}}catch(e){i.e(e)}finally{i.f()}this.children.forEach(function(e){n.el.appendChild(e.el)})}},{key:"show",value:function(e,n){this.payload=n,e.preventDefault(),e.stopPropagation(),this.removeAllHover(),this.removeChildMenus(),this.el.style.display="block";var t=window.outerWidth-window.innerWidth;this.height=parseFloat(getComputedStyle(this.el).height);var i=e.clientX,n=e.clientY;window.innerWidth-e.clientX-t<this.width&&(i=e.clientX-this.width),window.innerHeight-e.clientY-t<this.height&&(n=e.clientY-this.height),this.el.style.transform="translate(".concat(i,"px,").concat(n,"px)")}},{key:"hide",value:function(){this.el.style.display="none"}},{key:"removeAllHover",value:function(){this.children.forEach(function(e){e.el.classList.remove("".concat(config.wrapperClassName,"_hover"))})}},{key:"removeChildMenus",value:function(){this.children.forEach(function(e){null!==(e=e.childMenu)&&void 0!==e&&e.el.remove()})}},{key:"removeItemHover",value:function(){this.children.forEach(function(e){e.el.classList.remove("".concat(config.wrapperClassName,"_hover"))})}},{key:"closeAllMenus",value:function(){document.querySelectorAll(".".concat(config.wrapperClassName)).forEach(function(e){0<e.dataset.lv?e.remove():e.style.display="none"})}}]),t}(),_cssStr="\n  .".concat(config.wrapperClassName,", .").concat(config.wrapperClassName," *{\n    box-sizing: border-box;\n  }\n  .").concat(config.wrapperClassName,"{\n    -webkit-user-select:none;\n    user-select: none;\n    border: 1px solid #ddd;\n    left: 0;top:0;\n    background-color: #fff;\n    padding: 2px 0 2px 0px;\n    margin: 0;\n    cursor: default;\n    width: ").concat(config.defaultMenuWidth,"px;\n    display: none;\n  }\n  /*主菜单*/\n  .").concat(config.wrapperClassName,'[data-lv="0"]{ \n    position: fixed;\n  }\n  /*子菜单*/\n  .').concat(config.wrapperClassName," .").concat(config.wrapperClassName,"{ \n    position: absolute;\n  }\n  .").concat(config.wrapperClassName," .divide{\n    margin: ").concat(config.menuItemDivideLineMargin,"px 0;\n    height: 1px;\n    background-color: #ddd;\n  }\n  .").concat(config.wrapperClassName," li {\n    position: relative;\n    padding: 0 30px 0 30px;\n    list-style: none;\n    line-height: ").concat(config.menuItemHeight,"px;\n    font-size: 13px;\n    display: flex;\n    justify-content: space-between;\n    flex-wrap: nowrap;\n  }\n  .").concat(config.wrapperClassName," li.disabled{\n    color: #aaa;\n    pointer-events: none;\n  }\n  .").concat(config.wrapperClassName," li span.label {\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  .").concat(config.wrapperClassName," li span.tip{\n    color:#aaa;\n    font-size: 12px;\n  }\n  .").concat(config.wrapperClassName," li:hover:not(.divide):not(.disabled),\n  .").concat(config.wrapperClassName," li.").concat(config.wrapperClassName,"_hover{\n    background-color: #eee;\n  }\n  .").concat(config.wrapperClassName," li:hover:not(.divide):not(.disabled) .tip,\n  .").concat(config.wrapperClassName," li.").concat(config.wrapperClassName,"_hover .tip{\n    color: #000;\n  }\n  .").concat(config.wrapperClassName," li .right-arrow {\n    position: absolute;\n    right: 8px;\n    top: 9px;\n    border-top: 4px solid rgba(0,0,0,0);\n    border-left: 4px solid #000;\n    border-right: 4px solid rgba(0,0,0,0);\n    border-bottom: 4px solid rgba(0,0,0,0);\n  }\n  .").concat(config.wrapperClassName,"_child{\n    width: ").concat(config.childMenuWidth,"px;\n  }\n  "),ContextMenu=function(){function n(e){_classCallCheck(this,n),_defineProperty(this,"storeMenus",[]),_defineProperty(this,"clickEventFunc",void 0),_defineProperty(this,"config",void 0),this.injectCss(),this.hideMenuEventListener(),null!=e&&e.hideMenuWhenScroll&&this.scrollListener()}return _createClass(n,[{key:"injectCss",value:function(){var e;(e=document.querySelector("#".concat(config.cssId)))||(e=h("style#".concat(config.cssId),{innerHTML:_cssStr}),document.head.appendChild(e))}},{key:"hideMenuEventListener",value:function(){var e=this;this.clickEventFunc||(this.clickEventFunc=function(){e.storeMenus.some(function(e){return"block"===e.el.style.display})&&e.hideAllMenu()},window.addEventListener("click",this.clickEventFunc,{capture:!0}))}},{key:"scrollListener",value:function(){var e=this;window.addEventListener("scroll",function(){e.hideAllMenu()})}},{key:"create",value:function(e){e=new Menu(0,e);return this.storeMenus.push(e),document.body.appendChild(e.el),e}},{key:"showMenu",value:function(e,n,t){this.storeMenus.forEach(function(e){e.hide()}),n.show(e,t)}},{key:"hideAllMenu",value:function(){this.storeMenus.forEach(function(e){e.el.style.display="none"})}}]),n}();export{ContextMenu as default};
//# sourceMappingURL=index.es5.min.js.map
