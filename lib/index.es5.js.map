{"version":3,"file":"index.es5.js","sources":["../src/utils/h.ts","../src/config.js","../src/MenuItem.js","../src/Menu.js","../src/ContextMenu.js"],"sourcesContent":[null,"export default {\r\n  cssId: 'jacontextmenu-css',\r\n  wrapperClassName: 'jacontextmenu',\r\n  defaultMenuWidth: 200,\r\n  // childMenuWidth: 150,\r\n  menuItemHeight: 24,\r\n  menuItemDivideLineMargin: 5, // type == 'divide'\r\n  baseZIndex: 1000, // 基准z-index\r\n};\r\n","import h from './utils/h.ts';\r\nimport Menu from './Menu.js';\r\nimport config from './config.js';\r\n/**\r\n * Menu item\r\n */\r\nexport default class MenuItem {\r\n  /** @type {Menu} */\r\n  parentMenu;\r\n  /** @type {Number} 0 1*/\r\n  level;\r\n  /** @type {HTMLElement} element*/\r\n  el;\r\n  /** @type {Object} item option*/\r\n  itemOption;\r\n  /** @type {Menu} */\r\n  childMenu;\r\n  constructor(level, item, parentMenu) {\r\n    // console.log(parentMenu);\r\n    this.parentMenu = parentMenu;\r\n    this.level = level;\r\n    this.itemOption = item; // save option\r\n    this.init();\r\n  }\r\n  init() {\r\n    const item = this.itemOption;\r\n    if (item.type === 'divide' || item.type?.indexOf('---') === 0) {\r\n      this.el = h('li.divide');\r\n    } else {\r\n      this.el = h(\r\n        'li',\r\n        {\r\n          classList: item.disabled ? ['disabled'] : [],\r\n          onclick: (e) => {\r\n            if (!item.disabled) {\r\n              const payload = this.parentMenu.payload;\r\n              item.onclick && item.onclick(e, payload);\r\n              if (!item.children) this.parentMenu.closeAllMenus();\r\n            }\r\n          },\r\n          // onmouseenter: it.children?.length\r\n          //   ? (e) => this.#showChildMenu(e, it.children, contextMenuEle)\r\n          //   : () => this.#hideChildMenu(contextMenuEle),\r\n          onmouseenter: item.children\r\n            ? (e) => {\r\n                this.showChildMenu(e);\r\n              }\r\n            : () => {\r\n                this.hideOtherChildMenu(); // 移除所有子菜单\r\n              },\r\n        },\r\n        [h('span.label', item.label), item.tip && h('span.tip', item.tip), item.children && h('span.right-arrow')]\r\n      );\r\n    }\r\n    if (item.children) {\r\n      if (!item.children.width) item.children.width = this.parentMenu.width; // 不设置宽度则继承父菜单宽度\r\n      this.childMenu = new Menu(this.level + 1, item.children);\r\n    }\r\n  }\r\n  // 展示子菜单\r\n  showChildMenu(e) {\r\n    const childMenuEle = this.childMenu.el;\r\n    // if childMenuEle is hidden\r\n    if (!e.target.contains(childMenuEle)) {\r\n      e.target.classList.add(config.wrapperClassName + '_hover');\r\n      childMenuEle.style.display = 'block';\r\n\r\n      const childMenuHeight = parseFloat(getComputedStyle(childMenuEle).height);\r\n      const liPosition = e.target.getBoundingClientRect();\r\n      let translateX = this.parentMenu.width - 5;\r\n      let translateY = -2; // paddingTop\r\n      // right avaliable space\r\n      if (window.innerWidth - liPosition.x - this.parentMenu.width < this.childMenu.width) {\r\n        translateX = -this.childMenu.width + 5;\r\n      }\r\n      // bottom avaliable space\r\n      if (window.innerWidth - liPosition.y + 2 < childMenuHeight) {\r\n        translateY = -childMenuHeight + config.menuItemHeight + 2 + 1; // 1px border\r\n      }\r\n      this.childMenu.removeChildMenus();\r\n      childMenuEle.style.transform = `translate(${translateX}px, ${translateY}px)`;\r\n    }\r\n    this.el.appendChild(childMenuEle);\r\n    this.childMenu.removeAllHover(); // 取消hover\r\n    this.childMenu.payload = this.parentMenu.payload; // payload传入子菜单\r\n  }\r\n  hideOtherChildMenu() {\r\n    this.parentMenu?.removeChildMenus(); // 移除所有子菜单\r\n    this.parentMenu?.removeItemHover(); // 取消hover状态\r\n  }\r\n}\r\n","import h from './utils/h.ts';\r\nimport config from './config.js';\r\nimport MenuItem from './MenuItem.js';\r\n\r\n/**\r\n * 第一层menu保留el，使用display控制显示隐藏\r\n * 第二层后的menu使用remove来控制显示隐藏\r\n */\r\nexport default class Menu {\r\n  /** @type {Number} 0 1*/\r\n  level;\r\n  /** @type {HTMLElement} element*/\r\n  el;\r\n  /** @type {Number} menu width 传百分比就不好计算 */\r\n  width;\r\n  /** @type {Number} menu height 计算得出的菜单高度 */\r\n  height = 0;\r\n  /** @type {Array} config*/\r\n  items;\r\n  /** @type {Array<MenuItem>} */\r\n  children = [];\r\n  /** @type {any} 传入的参数 */\r\n  payload;\r\n  /** @type {{position:String}} */\r\n  innerOption;\r\n  constructor(level, option, innerOption) {\r\n    this.level = level;\r\n    this.items = option.items;\r\n    this.width = option.width || config.defaultMenuWidth;\r\n    this.innerOption = innerOption;\r\n    this.init();\r\n    this.addChildren(option.items);\r\n  }\r\n  init() {\r\n    // 生成最外层元素\r\n    this.el = h(`ul.${config.wrapperClassName}.${config.wrapperClassName}-lv${this.level}`, {\r\n      dataset: {\r\n        lv: this.level,\r\n      },\r\n      style: {\r\n        width: this.width + 'px',\r\n        zIndex: +config.baseZIndex + this.level,\r\n        position: this.innerOption?.position, // fix\r\n      },\r\n      onclick: (e) => e.stopPropagation(),\r\n      oncontextmenu: (e) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n      },\r\n    });\r\n  }\r\n  addChildren(items) {\r\n    if (!Array.isArray(items)) {\r\n      return console.error('option.items is not type of array');\r\n    }\r\n    for (const it of items) {\r\n      this.children.push(new MenuItem(this.level, it, this));\r\n    }\r\n    // 挂载li\r\n    this.children.forEach((item) => {\r\n      this.el.appendChild(item.el);\r\n    });\r\n  }\r\n  // 展示菜单\r\n  show(e, payload) {\r\n    this.payload = payload;\r\n    e.preventDefault();\r\n    e.stopPropagation(); // 防止触发祖先元素定义的contextmenu事件\r\n    this.removeAllHover(); // 移除所有hover\r\n    this.removeChildMenus(); // 打开的时候不会展示任何子菜单\r\n    this.calcPosition(e);\r\n    this.el.style.display = 'block';\r\n  }\r\n  // 计算出现的位置\r\n  calcPosition(e) {\r\n    const scrollWidth = window.outerWidth - window.innerWidth;\r\n    this.height = parseFloat(getComputedStyle(this.el).height);\r\n    let translateX = e.clientX;\r\n    let translateY = e.clientY + (this.level === 0 && !this.innerOption.position ? window.scrollY : 0);\r\n    // right not have enough space\r\n    if (window.innerWidth - e.clientX - scrollWidth < this.width) {\r\n      translateX = e.clientX - this.width;\r\n    }\r\n    // bottom not have enough space\r\n    if (window.innerHeight - e.clientY - scrollWidth < this.height) {\r\n      translateY = e.clientY - this.height;\r\n    }\r\n    this.el.style.transform = `translate(${translateX}px,${translateY}px)`;\r\n  }\r\n  // 隐藏菜单\r\n  hide() {\r\n    this.el.style.display = 'none';\r\n  }\r\n  // 移除所有hover\r\n  removeAllHover() {\r\n    this.children.forEach((item) => {\r\n      item.el.classList.remove(`${config.wrapperClassName}_hover`);\r\n    });\r\n  }\r\n  // 移除所有子菜单\r\n  removeChildMenus() {\r\n    this.children.forEach((item) => {\r\n      item.childMenu?.el.remove();\r\n    });\r\n  }\r\n  // 移除选项hover\r\n  removeItemHover() {\r\n    this.children.forEach((childItem) => {\r\n      childItem.el.classList.remove(`${config.wrapperClassName}_hover`);\r\n    });\r\n  }\r\n  // 关闭所有菜单\r\n  closeAllMenus() {\r\n    let menus = document.querySelectorAll(`.${config.wrapperClassName}`);\r\n    menus.forEach((menu) => {\r\n      let level = menu.dataset.lv;\r\n      if (level > 0) {\r\n        menu.remove();\r\n      } else {\r\n        menu.style.display = 'none';\r\n      }\r\n    });\r\n  }\r\n}\r\n","import h from './utils/h.ts';\r\n// import debounce from './utils/debounce.js';\r\nimport config from './config.js';\r\n// import store from './store.js';\r\nimport Menu from './Menu.js';\r\n\r\nconst _cssStr = `\r\n  .${config.wrapperClassName}, .${config.wrapperClassName} *{\r\n    box-sizing: border-box;\r\n  }\r\n  .${config.wrapperClassName}{\r\n    -webkit-user-select:none;\r\n    user-select: none;\r\n    border: 1px solid #ddd;\r\n    left: 0;top:0;\r\n    background-color: #fff;\r\n    padding: 2px 0 2px 0px;\r\n    margin: 0;\r\n    cursor: default;\r\n    width: ${config.defaultMenuWidth}px;\r\n    display: none;\r\n  }\r\n  /*主菜单*/\r\n  .${config.wrapperClassName}[data-lv=\"0\"]{ \r\n    position: absolute;\r\n  }\r\n  /*子菜单*/\r\n  .${config.wrapperClassName} .${config.wrapperClassName}{ \r\n    position: absolute;\r\n  }\r\n  .${config.wrapperClassName} .divide{\r\n    margin: ${config.menuItemDivideLineMargin}px 0;\r\n    height: 1px;\r\n    background-color: #ddd;\r\n  }\r\n  .${config.wrapperClassName} li {\r\n    position: relative;\r\n    padding: 0 30px 0 30px;\r\n    list-style: none;\r\n    line-height: ${config.menuItemHeight}px;\r\n    font-size: 13px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-wrap: nowrap;\r\n  }\r\n  .${config.wrapperClassName} li.disabled{\r\n    color: #aaa;\r\n    pointer-events: none;\r\n  }\r\n  .${config.wrapperClassName} li span.label {\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n  .${config.wrapperClassName} li span.tip{\r\n    color:#aaa;\r\n    font-size: 12px;\r\n  }\r\n  .${config.wrapperClassName} li:hover:not(.divide):not(.disabled),\r\n  .${config.wrapperClassName} li.${config.wrapperClassName}_hover{\r\n    background-color: #eee;\r\n  }\r\n  .${config.wrapperClassName} li:hover:not(.divide):not(.disabled) .tip,\r\n  .${config.wrapperClassName} li.${config.wrapperClassName}_hover .tip{\r\n    color: #000;\r\n  }\r\n  .${config.wrapperClassName} li .right-arrow {\r\n    position: absolute;\r\n    right: 8px;\r\n    top: 9px;\r\n    border-top: 4px solid rgba(0,0,0,0);\r\n    border-left: 4px solid #000;\r\n    border-right: 4px solid rgba(0,0,0,0);\r\n    border-bottom: 4px solid rgba(0,0,0,0);\r\n  }\r\n  .${config.wrapperClassName}_child{\r\n    width: ${config.childMenuWidth}px;\r\n  }\r\n  `;\r\nexport default class ContextMenu {\r\n  /** @type {Menu} 保存生成的菜单,便于统一管理 */\r\n  storeMenus = [];\r\n  /** @type {Function} */\r\n  clickEventFunc;\r\n  /** @type {{fixMenuWhenScroll:Boolean, hideMenuWhenScroll:Boolean}} */\r\n  config;\r\n  constructor(config) {\r\n    this.injectCss();\r\n    // this.#onPageResize();\r\n    this.hideMenuEventListener();\r\n    const defaultConfig = {\r\n      fixMenuWhenScroll: true,\r\n      hideMenuWhenScroll: false,\r\n    };\r\n    this.config = Object.assign(defaultConfig, config);\r\n    if (this.config.hideMenuWhenScroll) {\r\n      this.scrollListener();\r\n    }\r\n  }\r\n  // 注入css\r\n  injectCss() {\r\n    let style = document.querySelector(`#${config.cssId}`);\r\n    if (!style) {\r\n      // if not be injected\r\n      style = h(`style#${config.cssId}`, {\r\n        innerHTML: _cssStr,\r\n      });\r\n      document.head.appendChild(style);\r\n    }\r\n  }\r\n  /** click and close menu listener */\r\n  hideMenuEventListener() {\r\n    // add once event\r\n    if (!this.clickEventFunc) {\r\n      this.clickEventFunc = () => {\r\n        if (this.storeMenus.some((it) => it.el.style.display === 'block')) {\r\n          // 存在打开的菜单才关闭\r\n          this.hideAllMenu();\r\n        }\r\n      };\r\n      window.addEventListener('click', this.clickEventFunc, { capture: true });\r\n    }\r\n  }\r\n  /** if scroll hide all menu */\r\n  scrollListener() {\r\n    window.addEventListener('scroll', () => {\r\n      this.hideAllMenu();\r\n    });\r\n  }\r\n  /**\r\n   *\r\n   * @param {Array<Object>} items 配置\r\n   * @returns\r\n   */\r\n  create(option) {\r\n    let innerOptiton = {};\r\n    if (this.config.fixMenuWhenScroll) {\r\n      innerOptiton.position = 'fixed';\r\n    }\r\n    const mainMenu = new Menu(0, option, innerOptiton);\r\n    this.storeMenus.push(mainMenu);\r\n    document.body.appendChild(mainMenu.el);\r\n    return {\r\n      show: (e, payload) => {\r\n        this.showMenu(e, mainMenu, payload);\r\n      },\r\n    };\r\n  }\r\n  /** 监听窗口 */\r\n  // #onPageResize() {\r\n  //   let resizeFunc = debounce(() => {\r\n  //     // save window inner size\r\n  //     store.windowSize = {\r\n  //       width: window.innerWidth,\r\n  //       height: window.innerHeight,\r\n  //     };\r\n  //   });\r\n  //   window.addEventListener('resize', resizeFunc);\r\n  // }\r\n  /**\r\n   * 展示菜单\r\n   * @param {Menu} menu\r\n   */\r\n  showMenu(e, menu, payload) {\r\n    // 隐藏其他菜单\r\n    this.storeMenus.forEach((item) => {\r\n      item.hide();\r\n    });\r\n    menu.show(e, payload);\r\n  }\r\n  hideAllMenu() {\r\n    this.storeMenus.forEach((menu) => {\r\n      menu.el.style.display = 'none';\r\n    });\r\n  }\r\n}\r\n"],"names":["h","tag","attrs","children","id","match","classArr","map","it","substring","elem","document","createElement","Array","isArray","attr","key","concat","textContent","String","_a","classList","add","forEach","child","HTMLElement","appendChild","undefined","console","error","cssId","wrapperClassName","defaultMenuWidth","menuItemHeight","menuItemDivideLineMargin","baseZIndex","MenuItem","level","item","parentMenu","itemOption","init","type","indexOf","el","disabled","onclick","e","payload","closeAllMenus","onmouseenter","showChildMenu","hideOtherChildMenu","label","tip","width","childMenu","Menu","childMenuEle","target","contains","config","style","display","childMenuHeight","parseFloat","getComputedStyle","height","liPosition","getBoundingClientRect","translateX","translateY","window","innerWidth","x","y","removeChildMenus","transform","removeAllHover","removeItemHover","option","innerOption","items","addChildren","dataset","lv","zIndex","position","stopPropagation","oncontextmenu","preventDefault","push","calcPosition","scrollWidth","outerWidth","clientX","clientY","scrollY","innerHeight","remove","childItem","menus","querySelectorAll","menu","_cssStr","childMenuWidth","ContextMenu","injectCss","hideMenuEventListener","defaultConfig","fixMenuWhenScroll","hideMenuWhenScroll","Object","assign","scrollListener","querySelector","innerHTML","head","clickEventFunc","storeMenus","some","hideAllMenu","addEventListener","capture","innerOptiton","mainMenu","body","show","showMenu","hide"],"mappings":";;;;;;;;;;;;;;;;SAewBA,EACtBC,KACAC,OACAC;;;AAIA,MAAIC,EAAE,GAAGH,GAAG,CAACI,KAAJ,CAAU,YAAV,CAAT;AAEA,MAAIC,QAAQ,GAAaL,GAAG,CAACI,KAAJ,CAAU,cAAV,KAA6B,EAAtD;AACAC,EAAAA,QAAQ,GAAGA,QAAQ,CAACC,GAAT,CAAa,UAACC,EAAD;AAAQ,WAAAA,EAAE,CAACC,SAAH,CAAa,CAAb,CAAA;AAAe,GAApC,CAAX;AACAR,EAAAA,GAAG,GAAGA,GAAG,CAACI,KAAJ,CAAU,UAAV,EAAsB,CAAtB,CAAN;AAEA,MAAIK,IAAI,GAAQC,QAAQ,CAACC,aAAT,CAAuBX,GAAvB,CAAhB;AACA,MAAIG,EAAJ,EAAQM,IAAI,CAACN,EAAL,GAAUA,EAAE,CAAC,CAAD,CAAF,CAAMK,SAAN,CAAgB,CAAhB,CAAV;;AAER,MAAII,KAAK,CAACC,OAAN,CAAcZ,KAAd,CAAJ,EAA0B;AACxBC,IAAAA,QAAQ,GAAGD,KAAX;AACD,GAFD,MAEO,IAAI,QAAOA,KAAP,MAAiB,QAAjB,IAA6BA,KAAK,KAAK,IAA3C,EAAiD;AACtD,SAAK,IAAMa,IAAX,IAAmBb,KAAnB,EAA0B;AACxB,UAAIa,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,SAAjC,EAA4C;AAC1C,aAAK,IAAMC,GAAX,IAAkBd,KAAK,CAACa,IAAD,CAAvB,EAA+B;AAC7BL,UAAAA,IAAI,CAACK,IAAD,CAAJ,CAAWC,GAAX,IAAkBd,KAAK,CAACa,IAAD,CAAL,CAAYC,GAAZ,CAAlB;AACD;AACF,OAJD,MAIO,IAAID,IAAI,KAAK,WAAT,IAAwBF,KAAK,CAACC,OAAN,CAAcZ,KAAK,CAACa,IAAD,CAAnB,CAA5B,EAAwD;AAC7DT,QAAAA,QAAQ,GAAGA,QAAQ,CAACW,MAAT,CAAgBf,KAAK,CAACa,IAAD,CAArB,CAAX;AACD,OAFM,MAEA;AACLL,QAAAA,IAAI,CAACK,IAAD,CAAJ,GAAab,KAAK,CAACa,IAAD,CAAlB;AACD;AACF;AACF,GAZM,MAYA,IAAI,OAAOb,KAAP,KAAiB,QAAjB,IAA6B,OAAOA,KAAP,KAAiB,QAAlD,EAA4D;AACjEQ,IAAAA,IAAI,CAACQ,WAAL,GAAmBC,MAAM,CAACjB,KAAD,CAAzB;AACD;;AAED,MAAII,QAAJ,EAAc,CAAAc,KAAAV,IAAI,CAACW,SAAL,EAAeC,GAAf,MAAA,GAAA,EAAsBhB,QAAtB;;AACd,MAAIH,QAAJ,EAAc;AACZA,IAAAA,QAAQ,CAACoB,OAAT,CAAiB,UAACC,KAAD;AACf,UAAIA,KAAK,YAAYC,WAArB,EAAkCf,IAAI,CAACgB,WAAL,CAAiBF,KAAjB,EAAlC,KACK,IAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKG,SAAhC,EACHC,OAAO,CAACC,KAAR,CAAcL,KAAd,EAAqB,6BAArB;AACH,KAJD;AAKD;;AAED,SAAOd,IAAP;;;AC1DF,aAAe;AACboB,EAAAA,KAAK,EAAE,mBADM;AAEbC,EAAAA,gBAAgB,EAAE,eAFL;AAGbC,EAAAA,gBAAgB,EAAE,GAHL;;AAKbC,EAAAA,cAAc,EAAE,EALH;AAMbC,EAAAA,wBAAwB,EAAE,CANb;;AAObC,EAAAA,UAAU,EAAE,IAPC;;AAAA,CAAf;ACGA;AACA;AACA;;IACqBC;;;;;;;;;;AAWnB,oBAAYC,KAAZ,EAAmBC,IAAnB,EAAyBC,UAAzB,EAAqC;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;;AAEnC,SAAKA,UAAL,GAAkBA,UAAlB;AACA,SAAKF,KAAL,GAAaA,KAAb;AACA,SAAKG,UAAL,GAAkBF,IAAlB,CAJmC;;AAKnC,SAAKG,IAAL;AACD;;;;WACD,gBAAO;AAAA;AAAA;;AACL,UAAMH,IAAI,GAAG,KAAKE,UAAlB;;AACA,UAAIF,IAAI,CAACI,IAAL,KAAc,QAAd,IAA0B,eAAAJ,IAAI,CAACI,IAAL,0DAAWC,OAAX,CAAmB,KAAnB,OAA8B,CAA5D,EAA+D;AAC7D,aAAKC,EAAL,GAAU5C,CAAC,CAAC,WAAD,CAAX;AACD,OAFD,MAEO;AACL,aAAK4C,EAAL,GAAU5C,CAAC,CACT,IADS,EAET;AACEqB,UAAAA,SAAS,EAAEiB,IAAI,CAACO,QAAL,GAAgB,CAAC,UAAD,CAAhB,GAA+B,EAD5C;AAEEC,UAAAA,OAAO,EAAE,iBAACC,CAAD,EAAO;AACd,gBAAI,CAACT,IAAI,CAACO,QAAV,EAAoB;AAClB,kBAAMG,OAAO,GAAG,KAAI,CAACT,UAAL,CAAgBS,OAAhC;AACAV,cAAAA,IAAI,CAACQ,OAAL,IAAgBR,IAAI,CAACQ,OAAL,CAAaC,CAAb,EAAgBC,OAAhB,CAAhB;AACA,kBAAI,CAACV,IAAI,CAACnC,QAAV,EAAoB,KAAI,CAACoC,UAAL,CAAgBU,aAAhB;AACrB;AACF,WARH;;;;AAYEC,UAAAA,YAAY,EAAEZ,IAAI,CAACnC,QAAL,GACV,UAAC4C,CAAD,EAAO;AACL,YAAA,KAAI,CAACI,aAAL,CAAmBJ,CAAnB;AACD,WAHS,GAIV,YAAM;AACJ,YAAA,KAAI,CAACK,kBAAL,GADI;;AAEL;AAlBP,SAFS,EAsBT,CAACpD,CAAC,CAAC,YAAD,EAAesC,IAAI,CAACe,KAApB,CAAF,EAA8Bf,IAAI,CAACgB,GAAL,IAAYtD,CAAC,CAAC,UAAD,EAAasC,IAAI,CAACgB,GAAlB,CAA3C,EAAmEhB,IAAI,CAACnC,QAAL,IAAiBH,CAAC,CAAC,kBAAD,CAArF,CAtBS,CAAX;AAwBD;;AACD,UAAIsC,IAAI,CAACnC,QAAT,EAAmB;AACjB,YAAI,CAACmC,IAAI,CAACnC,QAAL,CAAcoD,KAAnB,EAA0BjB,IAAI,CAACnC,QAAL,CAAcoD,KAAd,GAAsB,KAAKhB,UAAL,CAAgBgB,KAAtC,CADT;;AAEjB,aAAKC,SAAL,GAAiB,IAAIC,IAAJ,CAAS,KAAKpB,KAAL,GAAa,CAAtB,EAAyBC,IAAI,CAACnC,QAA9B,CAAjB;AACD;AACF;;;;WAED,uBAAc4C,CAAd,EAAiB;AACf,UAAMW,YAAY,GAAG,KAAKF,SAAL,CAAeZ,EAApC,CADe;;AAGf,UAAI,CAACG,CAAC,CAACY,MAAF,CAASC,QAAT,CAAkBF,YAAlB,CAAL,EAAsC;AACpCX,QAAAA,CAAC,CAACY,MAAF,CAAStC,SAAT,CAAmBC,GAAnB,CAAuBuC,MAAM,CAAC9B,gBAAP,GAA0B,QAAjD;AACA2B,QAAAA,YAAY,CAACI,KAAb,CAAmBC,OAAnB,GAA6B,OAA7B;AAEA,YAAMC,eAAe,GAAGC,UAAU,CAACC,gBAAgB,CAACR,YAAD,CAAhB,CAA+BS,MAAhC,CAAlC;AACA,YAAMC,UAAU,GAAGrB,CAAC,CAACY,MAAF,CAASU,qBAAT,EAAnB;AACA,YAAIC,UAAU,GAAG,KAAK/B,UAAL,CAAgBgB,KAAhB,GAAwB,CAAzC;AACA,YAAIgB,UAAU,GAAG,CAAC,CAAlB,CAPoC;;;AASpC,YAAIC,MAAM,CAACC,UAAP,GAAoBL,UAAU,CAACM,CAA/B,GAAmC,KAAKnC,UAAL,CAAgBgB,KAAnD,GAA2D,KAAKC,SAAL,CAAeD,KAA9E,EAAqF;AACnFe,UAAAA,UAAU,GAAG,CAAC,KAAKd,SAAL,CAAeD,KAAhB,GAAwB,CAArC;AACD,SAXmC;;;AAapC,YAAIiB,MAAM,CAACC,UAAP,GAAoBL,UAAU,CAACO,CAA/B,GAAmC,CAAnC,GAAuCX,eAA3C,EAA4D;AAC1DO,UAAAA,UAAU,GAAG,CAACP,eAAD,GAAmBH,MAAM,CAAC5B,cAA1B,GAA2C,CAA3C,GAA+C,CAA5D,CAD0D;AAE3D;;AACD,aAAKuB,SAAL,CAAeoB,gBAAf;AACAlB,QAAAA,YAAY,CAACI,KAAb,CAAmBe,SAAnB,uBAA4CP,UAA5C,iBAA6DC,UAA7D;AACD;;AACD,WAAK3B,EAAL,CAAQlB,WAAR,CAAoBgC,YAApB;AACA,WAAKF,SAAL,CAAesB,cAAf,GAvBe;;AAwBf,WAAKtB,SAAL,CAAeR,OAAf,GAAyB,KAAKT,UAAL,CAAgBS,OAAzC,CAxBe;AAyBhB;;;WACD,8BAAqB;AAAA;;AACnB,+BAAKT,UAAL,sEAAiBqC,gBAAjB,GADmB;;AAEnB,gCAAKrC,UAAL,wEAAiBwC,eAAjB,GAFmB;AAGpB;;;;;ACrFH;AACA;AACA;AACA;;;IACqBtB;;;;;;;;;;;;;;;;AAiBnB,gBAAYpB,KAAZ,EAAmB2C,MAAnB,EAA2BC,WAA3B,EAAwC;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,oCAT/B,CAS+B;;AAAA;;AAAA,sCAL7B,EAK6B;;AAAA;;AAAA;;AACtC,SAAK5C,KAAL,GAAaA,KAAb;AACA,SAAK6C,KAAL,GAAaF,MAAM,CAACE,KAApB;AACA,SAAK3B,KAAL,GAAayB,MAAM,CAACzB,KAAP,IAAgBM,MAAM,CAAC7B,gBAApC;AACA,SAAKiD,WAAL,GAAmBA,WAAnB;AACA,SAAKxC,IAAL;AACA,SAAK0C,WAAL,CAAiBH,MAAM,CAACE,KAAxB;AACD;;;;WACD,gBAAO;AAAA;;;AAEL,WAAKtC,EAAL,GAAU5C,CAAC,cAAO6D,MAAM,CAAC9B,gBAAd,cAAkC8B,MAAM,CAAC9B,gBAAzC,gBAA+D,KAAKM,KAApE,GAA6E;AACtF+C,QAAAA,OAAO,EAAE;AACPC,UAAAA,EAAE,EAAE,KAAKhD;AADF,SAD6E;AAItFyB,QAAAA,KAAK,EAAE;AACLP,UAAAA,KAAK,EAAE,KAAKA,KAAL,GAAa,IADf;AAEL+B,UAAAA,MAAM,EAAE,CAACzB,MAAM,CAAC1B,UAAR,GAAqB,KAAKE,KAF7B;AAGLkD,UAAAA,QAAQ,uBAAE,KAAKN,WAAP,sDAAE,kBAAkBM,QAHvB;;AAAA,SAJ+E;AAStFzC,QAAAA,OAAO,EAAE,iBAACC,CAAD;AAAA,iBAAOA,CAAC,CAACyC,eAAF,EAAP;AAAA,SAT6E;AAUtFC,QAAAA,aAAa,EAAE,uBAAC1C,CAAD,EAAO;AACpBA,UAAAA,CAAC,CAACyC,eAAF;AACAzC,UAAAA,CAAC,CAAC2C,cAAF;AACD;AAbqF,OAA7E,CAAX;AAeD;;;WACD,qBAAYR,KAAZ,EAAmB;AAAA;;AACjB,UAAI,CAACrE,KAAK,CAACC,OAAN,CAAcoE,KAAd,CAAL,EAA2B;AACzB,eAAOtD,OAAO,CAACC,KAAR,CAAc,mCAAd,CAAP;AACD;;AAHgB,iDAIAqD,KAJA;AAAA;;AAAA;AAIjB,4DAAwB;AAAA,cAAb1E,EAAa;AACtB,eAAKL,QAAL,CAAcwF,IAAd,CAAmB,IAAIvD,QAAJ,CAAa,KAAKC,KAAlB,EAAyB7B,EAAzB,EAA6B,IAA7B,CAAnB;AACD,SANgB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQjB,WAAKL,QAAL,CAAcoB,OAAd,CAAsB,UAACe,IAAD,EAAU;AAC9B,QAAA,MAAI,CAACM,EAAL,CAAQlB,WAAR,CAAoBY,IAAI,CAACM,EAAzB;AACD,OAFD;AAGD;;;;WAED,cAAKG,CAAL,EAAQC,OAAR,EAAiB;AACf,WAAKA,OAAL,GAAeA,OAAf;AACAD,MAAAA,CAAC,CAAC2C,cAAF;AACA3C,MAAAA,CAAC,CAACyC,eAAF,GAHe;;AAIf,WAAKV,cAAL,GAJe;;AAKf,WAAKF,gBAAL,GALe;;AAMf,WAAKgB,YAAL,CAAkB7C,CAAlB;AACA,WAAKH,EAAL,CAAQkB,KAAR,CAAcC,OAAd,GAAwB,OAAxB;AACD;;;;WAED,sBAAahB,CAAb,EAAgB;AACd,UAAM8C,WAAW,GAAGrB,MAAM,CAACsB,UAAP,GAAoBtB,MAAM,CAACC,UAA/C;AACA,WAAKN,MAAL,GAAcF,UAAU,CAACC,gBAAgB,CAAC,KAAKtB,EAAN,CAAhB,CAA0BuB,MAA3B,CAAxB;AACA,UAAIG,UAAU,GAAGvB,CAAC,CAACgD,OAAnB;AACA,UAAIxB,UAAU,GAAGxB,CAAC,CAACiD,OAAF,IAAa,KAAK3D,KAAL,KAAe,CAAf,IAAoB,CAAC,KAAK4C,WAAL,CAAiBM,QAAtC,GAAiDf,MAAM,CAACyB,OAAxD,GAAkE,CAA/E,CAAjB,CAJc;;AAMd,UAAIzB,MAAM,CAACC,UAAP,GAAoB1B,CAAC,CAACgD,OAAtB,GAAgCF,WAAhC,GAA8C,KAAKtC,KAAvD,EAA8D;AAC5De,QAAAA,UAAU,GAAGvB,CAAC,CAACgD,OAAF,GAAY,KAAKxC,KAA9B;AACD,OARa;;;AAUd,UAAIiB,MAAM,CAAC0B,WAAP,GAAqBnD,CAAC,CAACiD,OAAvB,GAAiCH,WAAjC,GAA+C,KAAK1B,MAAxD,EAAgE;AAC9DI,QAAAA,UAAU,GAAGxB,CAAC,CAACiD,OAAF,GAAY,KAAK7B,MAA9B;AACD;;AACD,WAAKvB,EAAL,CAAQkB,KAAR,CAAce,SAAd,uBAAuCP,UAAvC,gBAAuDC,UAAvD;AACD;;;;WAED,gBAAO;AACL,WAAK3B,EAAL,CAAQkB,KAAR,CAAcC,OAAd,GAAwB,MAAxB;AACD;;;;WAED,0BAAiB;AACf,WAAK5D,QAAL,CAAcoB,OAAd,CAAsB,UAACe,IAAD,EAAU;AAC9BA,QAAAA,IAAI,CAACM,EAAL,CAAQvB,SAAR,CAAkB8E,MAAlB,WAA4BtC,MAAM,CAAC9B,gBAAnC;AACD,OAFD;AAGD;;;;WAED,4BAAmB;AACjB,WAAK5B,QAAL,CAAcoB,OAAd,CAAsB,UAACe,IAAD,EAAU;AAAA;;AAC9B,2BAAAA,IAAI,CAACkB,SAAL,oEAAgBZ,EAAhB,CAAmBuD,MAAnB;AACD,OAFD;AAGD;;;;WAED,2BAAkB;AAChB,WAAKhG,QAAL,CAAcoB,OAAd,CAAsB,UAAC6E,SAAD,EAAe;AACnCA,QAAAA,SAAS,CAACxD,EAAV,CAAavB,SAAb,CAAuB8E,MAAvB,WAAiCtC,MAAM,CAAC9B,gBAAxC;AACD,OAFD;AAGD;;;;WAED,yBAAgB;AACd,UAAIsE,KAAK,GAAG1F,QAAQ,CAAC2F,gBAAT,YAA8BzC,MAAM,CAAC9B,gBAArC,EAAZ;AACAsE,MAAAA,KAAK,CAAC9E,OAAN,CAAc,UAACgF,IAAD,EAAU;AACtB,YAAIlE,KAAK,GAAGkE,IAAI,CAACnB,OAAL,CAAaC,EAAzB;;AACA,YAAIhD,KAAK,GAAG,CAAZ,EAAe;AACbkE,UAAAA,IAAI,CAACJ,MAAL;AACD,SAFD,MAEO;AACLI,UAAAA,IAAI,CAACzC,KAAL,CAAWC,OAAX,GAAqB,MAArB;AACD;AACF,OAPD;AAQD;;;;;;ACpHH,IAAMyC,OAAO,kBACR3C,MAAM,CAAC9B,gBADC,gBACqB8B,MAAM,CAAC9B,gBAD5B,uDAIR8B,MAAM,CAAC9B,gBAJC,mOAaA8B,MAAM,CAAC7B,gBAbP,wEAiBR6B,MAAM,CAAC9B,gBAjBC,2FAqBR8B,MAAM,CAAC9B,gBArBC,eAqBoB8B,MAAM,CAAC9B,gBArB3B,kDAwBR8B,MAAM,CAAC9B,gBAxBC,oCAyBC8B,MAAM,CAAC3B,wBAzBR,2EA6BR2B,MAAM,CAAC9B,gBA7BC,kHAiCM8B,MAAM,CAAC5B,cAjCb,iIAuCR4B,MAAM,CAAC9B,gBAvCC,iFA2CR8B,MAAM,CAAC9B,gBA3CC,4FA+CR8B,MAAM,CAAC9B,gBA/CC,2EAmDR8B,MAAM,CAAC9B,gBAnDC,wDAoDR8B,MAAM,CAAC9B,gBApDC,iBAoDsB8B,MAAM,CAAC9B,gBApD7B,2DAuDR8B,MAAM,CAAC9B,gBAvDC,6DAwDR8B,MAAM,CAAC9B,gBAxDC,iBAwDsB8B,MAAM,CAAC9B,gBAxD7B,qDA2DR8B,MAAM,CAAC9B,gBA3DC,uQAoER8B,MAAM,CAAC9B,gBApEC,iCAqEA8B,MAAM,CAAC4C,cArEP,iBAAb;;IAwEqBC;;;;;;AAOnB,uBAAY7C,MAAZ,EAAoB;AAAA;;AAAA,wCALP,EAKO;;AAAA;;AAAA;;AAClB,SAAK8C,SAAL,GADkB;;AAGlB,SAAKC,qBAAL;AACA,QAAMC,aAAa,GAAG;AACpBC,MAAAA,iBAAiB,EAAE,IADC;AAEpBC,MAAAA,kBAAkB,EAAE;AAFA,KAAtB;AAIA,SAAKlD,MAAL,GAAcmD,MAAM,CAACC,MAAP,CAAcJ,aAAd,EAA6BhD,MAA7B,CAAd;;AACA,QAAI,KAAKA,MAAL,CAAYkD,kBAAhB,EAAoC;AAClC,WAAKG,cAAL;AACD;AACF;;;;;WAED,qBAAY;AACV,UAAIpD,KAAK,GAAGnD,QAAQ,CAACwG,aAAT,YAA2BtD,MAAM,CAAC/B,KAAlC,EAAZ;;AACA,UAAI,CAACgC,KAAL,EAAY;;AAEVA,QAAAA,KAAK,GAAG9D,CAAC,iBAAU6D,MAAM,CAAC/B,KAAjB,GAA0B;AACjCsF,UAAAA,SAAS,EAAEZ;AADsB,SAA1B,CAAT;AAGA7F,QAAAA,QAAQ,CAAC0G,IAAT,CAAc3F,WAAd,CAA0BoC,KAA1B;AACD;AACF;;;;;WAED,iCAAwB;AAAA;;;AAEtB,UAAI,CAAC,KAAKwD,cAAV,EAA0B;AACxB,aAAKA,cAAL,GAAsB,YAAM;AAC1B,cAAI,MAAI,CAACC,UAAL,CAAgBC,IAAhB,CAAqB,UAAChH,EAAD;AAAA,mBAAQA,EAAE,CAACoC,EAAH,CAAMkB,KAAN,CAAYC,OAAZ,KAAwB,OAAhC;AAAA,WAArB,CAAJ,EAAmE;;AAEjE,YAAA,MAAI,CAAC0D,WAAL;AACD;AACF,SALD;;AAMAjD,QAAAA,MAAM,CAACkD,gBAAP,CAAwB,OAAxB,EAAiC,KAAKJ,cAAtC,EAAsD;AAAEK,UAAAA,OAAO,EAAE;AAAX,SAAtD;AACD;AACF;;;;;WAED,0BAAiB;AAAA;;AACfnD,MAAAA,MAAM,CAACkD,gBAAP,CAAwB,QAAxB,EAAkC,YAAM;AACtC,QAAA,MAAI,CAACD,WAAL;AACD,OAFD;AAGD;;AAEH;AACA;AACA;AACA;;;;WACE,gBAAOzC,MAAP,EAAe;AAAA;;AACb,UAAI4C,YAAY,GAAG,EAAnB;;AACA,UAAI,KAAK/D,MAAL,CAAYiD,iBAAhB,EAAmC;AACjCc,QAAAA,YAAY,CAACrC,QAAb,GAAwB,OAAxB;AACD;;AACD,UAAMsC,QAAQ,GAAG,IAAIpE,IAAJ,CAAS,CAAT,EAAYuB,MAAZ,EAAoB4C,YAApB,CAAjB;AACA,WAAKL,UAAL,CAAgB5B,IAAhB,CAAqBkC,QAArB;AACAlH,MAAAA,QAAQ,CAACmH,IAAT,CAAcpG,WAAd,CAA0BmG,QAAQ,CAACjF,EAAnC;AACA,aAAO;AACLmF,QAAAA,IAAI,EAAE,cAAChF,CAAD,EAAIC,OAAJ,EAAgB;AACpB,UAAA,MAAI,CAACgF,QAAL,CAAcjF,CAAd,EAAiB8E,QAAjB,EAA2B7E,OAA3B;AACD;AAHI,OAAP;AAKD;;;;;;;;;;;;;;AAaH;AACA;AACA;;;;WACE,kBAASD,CAAT,EAAYwD,IAAZ,EAAkBvD,OAAlB,EAA2B;;AAEzB,WAAKuE,UAAL,CAAgBhG,OAAhB,CAAwB,UAACe,IAAD,EAAU;AAChCA,QAAAA,IAAI,CAAC2F,IAAL;AACD,OAFD;AAGA1B,MAAAA,IAAI,CAACwB,IAAL,CAAUhF,CAAV,EAAaC,OAAb;AACD;;;WACD,uBAAc;AACZ,WAAKuE,UAAL,CAAgBhG,OAAhB,CAAwB,UAACgF,IAAD,EAAU;AAChCA,QAAAA,IAAI,CAAC3D,EAAL,CAAQkB,KAAR,CAAcC,OAAd,GAAwB,MAAxB;AACD,OAFD;AAGD;;;;;;"}